# ligo-igo
Этот репозиторий содержит специфические скрипты и мануалы для специфических задач

Состав пакета:

Однократного действия:

archivarius.py

capibarakoroed.py
    image1.jpg
    image2.jpg
    image3.jpg
    video.mp4
    
Дежурные:
    
duty_capibarakoroed.py

reposter.py

khooylowbot.py


Инструкция по применению:

Перед началом работы полезно завести таблицу с названиями ботов, их токенами, данными api и отметить, каким скриптам они соответствуют и какие у них должны быть права. Также выясните SOURCE CHANNEL ID и TARGET CHANNEL ID, например, при помощи форварда сообщения с канала в адрес https://t.me/JsonDumpBot , проверьте их соответствие и добавьте их в таблицу. Помните, что токены ботов-админов, api id и api hash — крайне чувствительные данные, держите их в надежном месте.



Получение bot token:

Чтобы получить токен для бота в Телеграм, вам нужно выполнить следующие шаги:

1.Откройте приложение Telegram и найдите бота, который будете использовать.

2.Свяжитесь с BotFather. Это официальный бот Telegram, который поможет вам создать нового бота или получить токен для существующего.

3.Напишите BotFather'у сообщение "/newbot" и следуйте инструкциям, которые он даст вам в ответ. Вы должны будете указать имя вашего бота и его уникальный идентификатор (username).

4.После успешного создания бота BotFather пришлет вам сообщение с токеном вашего бота. Токен выглядит примерно так: "1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".

5. Сохраните токен в надежном месте, так как он будет использоваться вашим ботом для взаимодействия с Telegram API.



Получение API_ID и API_HASH

Для получения API ID и API HASH для Telegram API вы должны выполнить следующие действия:

1.Перейдите на сайт Telegram API (https://my.telegram.org/auth) и авторизуйтесь.

2.После авторизации вы увидите страницу с заголовком "API Development Tools".

3.На этой странице вам нужно создать новое приложение, нажав на кнопку "Создать новое приложение" (Create Application).

4.В появившемся окне заполните поля "Название" (App title) и "Сайт" (App website). Заполнение остальных полей необязательно.

5.После заполнения формы нажмите на кнопку "Создать приложение" (Create application, тип - Other, Python).

6.На следующей странице вы увидите ID приложения (API ID) и хеш приложения (API HASH). Сохраните их в надежном месте.

API ID и API HASH используются для аутентификации вашего приложения в Telegram API. Пожалуйста, не делитесь ими с другими людьми.



Добавление ботов в группы

Для того чтобы добавить бота в группу и сделать его администратором, нужно:

1.Найти бота в Telegram, используя его имя пользователя или название.

2.Нажать на имя бота и открыть чат с ним.

3.Нажать на кнопку "Добавить в группу" и выбрать группу, в которую вы хотите добавить бота.

4.Открыть настройки группы и выбрать раздел "Администраторы".

5.Нажать на кнопку "Добавить администратора" и выбрать добавленного бота из списка контактов.

6.Убедиться, что у бота нет никаких прав, иначе отмените их.

7.После того, как вы добавите бота в группу и сделаете его администратором, он начнет работать и отвечать на сообщения в этой группе.
 
 
Запуск ботов

Перед первым запуском пропишите в кодах ботов необходимые данные авторизации и поменяйте переменные, если необходимо. 

Все боты запускаются из консоли командой
    python3 [scriptname].py

Чтобы логи не сыпались в консоль, перед командами запуска поставьте nohup, например: 
    nohup python3 [scriptname].py
    
Скрипты будут сыпать свои логи в файл nohup.out, он будет расти в размере. Для отправки этих данных в null вместо файла используйте команду 
    nohup python3 [scriptname].py >/dev/null 2>&1
    
Некоторых ботов нужно будить, однократно написав им в приват /start. Другим это не требуется и не влияет на их работу. 
    


Порядок работы пакета:

Сначала один канал копируется на другой архивариусом, затем оригинальный архив уничтожается капибарой-короедом. По окончанию этих стадий запускаются дежурные скрипты, один из которых - репостер - сразу копирует все новые посты из оригинала в копию, подтирая плашку автора, а второй - дежурная капибара-короед - уничтожает каждый 12й пост с конца и ждет следующего апдейта, чтобы повторить. Дежурный хуйлобот может работать все время.

archivarius запускается раньше всех и обрабатывает порядка 5000 постов в сутки. capibarakoroed на хорошем соединении обрабатывает посты вдвое быстрее, поэтому рассчитайте время запуска так, чтобы archivarius успевал копировать посты раньше, чем до них доберется capibara. Когда закончит archivarius, дайте закончить капибаре и после этого запускайте reposter и duty_capibarakoroed. 
khooylowbot работает независимо от всех может быть запущен и остановлен в любое время. 


Если случился вылет или рестарт во время копирования канала:

archivarius - посмотрите номер последнего скопированного поста, поправьте стартовый номер в скрипте, после чего перезапустите;

capibarakoroed - вручную перебором номера поста в ссылке найдите последний поправленный пост. Если вводить URL в поле search телеграма, он сразу будет показывать превью поста в результатах, по которому будет видно, поправлен пост, или нет. Меняйте номер поста в url и найдите последний поправленный. Либо ищите поиском ключевое слово, если использовали уникальное. Выясните номер последнего и поправьте стартовый номер поста в скрипте, после чего перезапускайте.  


Если случился вылет или рестарт при работе дежурных скриптов:

Просто запустите снова.


Конкретнее кто что делает:


archivarius.py

Этот скрипт на языке Python используется для пересылки сообщений из одного канала в другой в Telegram. Он необходим, например, для архивации канала. Данный скрипт запускается один раз и работает, пока не скопирует весь канал. Боту необходимо быть администратором в обоих каналах.

Замените "YOUR_API_TOKEN" на свой токен бота Telegram. 

Замените "SOURCE_CHANNEL_ID" и "TARGET_CHANNEL_ID" на ID каналов, из которых и куда будут пересылаться сообщения.
Замените "START_MESSAGE_ID" на ID первого сообщения, которое нужно переслать.

После того, как вы внесете эти изменения, вы можете запустить скрипт. 
Сообщения будут пересылаться каждые 15 секунд до тех пор, пока вы не остановите скрипт вручную. Не рекомендуется уменьшать этот период из-за флудконтроля.

capibarakoroed.py

Данный скрипт предназначен для автоматического обновления медиа-файлов и подписи к сообщениям в заданном чате в Telegram. Для работы боту необходимо быть администратором с правами.

Для того, чтобы запустить этот скрипт, вам нужно:

Получить API ID и API HASH, создать бота и получить его токен.

Заменить YOUR_API_ID, YOUR_API_HASH, YOUR_BOT_TOKEN, YOUR_CHAT_ID на свои соответствующие значения.

Предварительно загрузить необходимые медиа-файлы (изображения и видео) в папку с данным скриптом.

Заменить caption_text на желаемую подпись к сообщениям, если необходимо.

Задать значения START_ID и END_ID - это идентификаторы сообщений в заданном чате, которые вы хотите обновить. END_ID+1 заставит капибару работать, пока не кончатся посты.

Сохранить изменения и запустить скрипт.
    
    
reposter.py

Этот скрипт на языке Python используется для пересылки сообщений из одного канала в другой в Telegram немедленно, при этом подтирая автора. Пропишите токен, замените "SOURCE_CHANNEL_ID" и "TARGET_CHANNEL_ID" на ID каналов, из которых и куда будут пересылаться сообщения. Добавьте бота в оба канала администратором. Скрипт готов к работе.
Особенности: игнорирует spoiler, не может наследовать caption entities в подписях к медиа, возможен разрыв галерей на медленных соединениях.


duty_capibarakoroed.py

Данный скрипт предназначен для автоматического обновления медиа-файлов и подписи к сообщениям в заданном чате в Telegram. Это дежурный бот. Замените YOUR_API_ID, YOUR_API_HASH, YOUR_BOT_TOKEN, YOUR_CHAT_ID на свои соответствующие значения.
Строки 23 и 24 содержат в конце номер поста с конца, с которого начнет капибара, в данном случае это 12(-12). Особенность: после запуска дежурная капибара слушает ровно столько постов, сколько указано в строках 23 и 24, и только со следующим после этого апдейта начнет работу. Медиафайлы должны быть в папке со скриптом.


khooylowbot.py

Этот cкрипт на языке Python выводит вашхи пользователей лексической редупликацией. Это дежурный бот. 
Для запуска бота вам нужно заменить "insert_token" в строке 10 на ваш токен и запустить скрипт. 
После запуска бот будет отвечать на сообщения в групповых чатах и личных сообщениях.
